"use strict";var contactsView={_viewInitialized:!1,onInit:function(t){_preventDefault(t),contactModel.deviceQueryActive=!1,$("#contacts-listview").kendoMobileListView({dataSource:contactModel.contactListDS,template:$("#contactsTemplate").html(),headerTemplate:$("#contactsHeaderTemplate").html(),fixedHeaders:!0,dataBound:function(t){ux.checkEmptyUIState(contactModel.contactListDS,"#contactListDiv >")}}).kendoTouch({filter:".contactListBox",enableSwipe:!0,tap:function(t){var e=t.touch.currentTarget.attributes["data-contact"].value,a=contactModel.findContactByUUID(e);return void 0===a?void mobileNotify("Contact List: no matching Contact in ContactsDS"):(contactModel.setCurrentContact(a),void("phone"===a.category?contactModel.unifiedDeviceContact?addContactView.openModal(a):APP.kendo.navigate("#contactImport?query="+a.name):"unknown"===a.category?(mobileNotify("Looking up "+a.name),contactModel.updateContactDetails(a.uuid,function(t){void 0!==t.contactUUID&&null!==t.contactUUID})):(contactActionView.openModal(a.uuid),void 0!==a.contactUUID&&null!==a.contactUUID?$("#contactActionBtns > li:first-child").show():$("#contactActionBtns > li:first-child").hide())))},swipe:function(t){var e=t.sender.events.currentTarget;if("left"===t.direction&&!$(e).hasClass("noSlide")){var a=$(".contact-active");$(a).velocity({translateX:"0"},{duration:"fast"}).removeClass("contact-active"),$(e).hasClass("member")&&$(window).width()<375?$(e).velocity({translateX:"-75%"},{duration:"fast"}).addClass("contact-active"):$(e).hasClass("member")?$(e).velocity({translateX:"-60%"},{duration:"fast"}).addClass("contact-active"):$(window).width()<375?$(e).velocity({translateX:"-85%"},{duration:"fast"}).addClass("contact-active"):$(e).velocity({translateX:"-75%"},{duration:"fast"}).addClass("contact-active")}"right"===t.direction&&$(e).hasClass("contact-active")&&$(e).velocity({translateX:"0"},{duration:"fast"}).removeClass("contact-active")}})},onShow:function(t){_preventDefault(t),contactsView._viewInitialized||(contactsView._viewInitialized=!0,$("#contacts .gg_mainSearchInput").on("input",function(){var t=this.value;t.length>0?(contactModel.contactListDS.filter({logic:"or",filters:[{field:"name",operator:"contains",value:t},{field:"alias",operator:"contains",value:t},{field:"group",operator:"contains",value:t}]}),$("#contacts .enterSearch").removeClass("hidden"),t.length>2&&$("#btnSearchDeviceContacts").removeClass("hidden"),$("#btnSearchDeviceName").text(t)):(contactModel.contactListDS.filter([]),contactsView.hideSearchUX(),$("#contacts .enterSearch").addClass("hidden"))}),$("#contacts .enterSearch").on("click",function(){$("#contacts .gg_mainSearchInput").val(""),contactModel.contactListDS.data(contactModel.contactListDS.data()),contactModel.contactListDS.filter([]),$("#btnSearchDeviceContacts").addClass("hidden"),$("#btnSearchDeviceName").val(""),$(this).addClass("hidden")})),$("#contacts .gg_mainSearchInput").attr("placeholder","Search contacts..."),contactModel.updateContactListStatus(),ux.showActionBtn(!0,"#contacts","#contactImport"),ux.showActionBtnText("#contacts","3em","New Contact")},updateContactListDS:function(){contactModel.contactListDS.data([]),contactModel.contactListDS.data(contactModel.contactsDS.data())},onHide:function(){ux.showActionBtn(!1,"#contacts"),$("#btnSearchDeviceContacts").addClass("hidden"),ux.hideSearch()},updateSearchUX:function(t){var e=$("#contacts .gg_mainSearchInput").val();e.length>2?($("#btnSearchDeviceName").text(e),$("#btnSearchDeviceContacts").removeClass("hidden")):contactsView.hideSearchUX()},hideSearchUX:function(){contactModel.deviceContactsDS.data([]),$("#btnSearchDeviceContacts").addClass("hidden")},searchDeviceContacts:function(t){_preventDefault(t),$("#contacts .enterSearch").addClass("hidden");var e=$("#contacts .gg_mainSearchInput").val();ux.hideSearch(),APP.kendo.navigate("#contactImport?query="+e)},doEditContact:function(t){_preventDefault(t);var e=t.button[0].attributes["data-contact"].value;APP.kendo.navigate("#editContact?contact="+e)},doBlockContact:function(t){_preventDefault(t);var e=t.button[0].attributes["data-contact"].value;contactModel.blockContact(e)},doUnBlockContact:function(t){_preventDefault(t);var e=t.button[0].attributes["data-contact"].value;contactModel.unblockContact(e)},doDeleteContact:function(t){_preventDefault(t);var e=t.button[0].attributes["data-contact"].value;contactModel.deleteContact(e);var a="Deleted contact: "+contactModel.currentContact.name+" ("+contactModel.currentContact.alias+")";mobileNotify(a),APP.kendo.navigate("#contacts")},doInviteContact:function(t){_preventDefault(t);var e=t.button[0].attributes["data-contact"].value,a=contactModel.findContactByUUID(e),c=a.email,o=a.inviteSent;void 0===o||o===!1?(contactSendEmailInvite(c),contactModel.currentContact.set("inviteSent",!0),contactModel.currentContact.set("lastInvite",ggTime.currentTime())):mobileNotify(a.name+"has already been invited")}},contactImportView={onInit:function(t){_preventDefault(t),$("#contactimport-listview").kendoMobileListView({dataSource:contactModel.deviceContactsDS,template:$("#deviceContactsTemplate").html(),headerTemplate:"${value}",fixedHeaders:!0,click:contactImportView.processDeviceContact,dataBinding:function(t){}}),$("#addContactPhone").change(function(){var t=$("#addContactPhone").val();mobileNotify("Please wait - validating phone..."),isValidMobileNumber(t,function(e){"ok"===e.status&&(e.valid===!1?mobileNotify("Sorry, "+t+"is not a  mobile number!"):mobileNotify("Success!! "+t+"is a mobile number"))})}),$("#contactImport .gg_mainSearchInput").attr("placeholder","Search device contacts..."),$("#contactImport .gg_mainSearchInput").on("input",function(t){var e=0,a=800,c=$(this).val();c.length>0?$("#contactImport .enterSearch").removeClass("hidden"):$("#contactImport .enterSearch").addClass("hidden"),c.length>2&&(window.clearTimeout(e),e=window.setTimeout(function(){contactImportView.searchContacts(c)},a))}).keyup(function(t){var e=$(this).val();13===t.keyCode&&contactImportView.searchContacts(e)}),$("#contactImport .enterSearch").on("click",function(){$("#contactImport .gg_mainSearchInput").val(""),contactModel.deviceContactsDS.filter([]),contactModel.deviceContactsDS.data(contactModel.deviceContactsDS.data()),$(this).addClass("hidden")})},onShow:function(t){_preventDefault(t);var e=null;e=t.view.params.query,null!==e&&void 0!==e?(deviceFindContacts(e),$("#contactImport .gg_mainSearchInput").val(e),$("#contactImport .enterSearch").removeClass("hidden")):($("#contactImport .gg_mainSearchInput").val(""),$("#contactImport .enterSearch").addClass("hidden")),$(".gg_mainSearchBox").css("display","block").data("visible",!0)},searchContacts:function(t){deviceFindContacts(t,function(t){})},onHide:function(t){},processDeviceContact:function(t){_preventDefault(),contactModel.currentDeviceContact=t.dataItem;var e=t.dataItem.name;mobileNotify("Unifying contact information for "+e),syncContactWithDevice(e,function(t){contactModel.emailArray=[];for(var e=0;e<contactModel.currentDeviceContact.emails.length;e++){var a={};a.name=contactModel.currentDeviceContact.emails[e].name,a.address=contactModel.currentDeviceContact.emails[e].address,contactModel.emailArray.push(a)}contactModel.phoneArray=[];for(var c=0;c<contactModel.currentDeviceContact.phoneNumbers.length;c++){var o={};o.name=contactModel.currentDeviceContact.phoneNumbers[c].name,o.number=contactModel.currentDeviceContact.phoneNumbers[c].number,contactModel.phoneArray.push(o)}contactModel.addressArray=[];for(var n=0;n<contactModel.currentDeviceContact.addresses.length;n++){var i={};i.name=contactModel.currentDeviceContact.addresses[n].name,i.address=contactModel.currentDeviceContact.addresses[n].fullAddress,contactModel.addressArray.push(i)}contactModel.phoneDS.data(contactModel.phoneArray),contactModel.emailDS.data(contactModel.emailArray),contactModel.addressDS.data(contactModel.addressArray);var d=contactModel.currentDeviceContact,s=d.name;$("#addContactName").val(s),null!==d.photo&&returnValidPhoto(d.photo,function(t){$("#addContactPhoto").attr("src",t)}),contactModel.deviceContactsDS.data([t[0]]),addContactView.openModal(t[0])})}},addContactView={_closeModal:!1,doInit:function(t){_preventDefault(t),$("#addContactPhone").on("input",function(){var t=$("#addContactPhone").val();isValidMobileNumber(t,function(e){"ok"===e.status&&(e.valid===!1?(mobileNotify(t+" is not a valid mobile number"),$("#vaildMobileNumberError").velocity("slideDown"),$("#addContacViewAddButton").text("Close"),addContactView._closeModal=!0):($("#vaildMobileNumberError").velocity("slideUp"),$("#addContacViewAddButton").text("Add Contact"),addContactView._closeModal=!1))})}),$("#addContactForm").kendoValidator({errorTemplate:'<span class="error-msg">#=message#</span>'})},openModal:function(t){var e=t,a=e.name;""!==a?($("#addContactName-blank").removeClass("hidden"),$("#addContactName, #addContactName-error").val(a)):$("#addContactName-blank").addClass("hidden"),null===e.photo?$("#addContactPhoto").attr("src","images/ghostgramcontact.png"):returnValidPhoto(e.photo,function(t){$("#addContactPhoto").attr("src",t)}),contactModel.emailArray=new Array;for(var c=0;c<contactModel.currentDeviceContact.emails.length;c++){var o=new Object;o.name=contactModel.currentDeviceContact.emails[c].name,o.address=contactModel.currentDeviceContact.emails[c].address,contactModel.emailArray.push(o)}contactModel.phoneArray=new Array;for(var n=0;n<contactModel.currentDeviceContact.phoneNumbers.length;n++){var i=new Object;i.name=contactModel.currentDeviceContact.phoneNumbers[n].name,i.number=contactModel.currentDeviceContact.phoneNumbers[n].number,contactModel.phoneArray.push(i)}contactModel.addressArray=new Array;for(var d=0;d<contactModel.currentDeviceContact.addresses.length;d++){var s=new Object;s.name=contactModel.currentDeviceContact.addresses[d].name,s.address=contactModel.currentDeviceContact.addresses[d].fullAddress,contactModel.addressArray.push(s)}contactModel.phoneDS.data(contactModel.phoneArray),contactModel.emailDS.data(contactModel.emailArray),contactModel.addressDS.data(contactModel.addressArray),$("#modalview-AddContact").data("kendoMobileModalView").open();var i=$("#addContactPhone").val();isValidMobileNumber(i,function(t){"ok"===t.status&&(t.valid===!1?(mobileNotify(i+" is not a valid mobile number"),$("#vaildMobileNumberError").velocity("slideDown"),$("#addContacViewAddButton").text("Close"),addContactView._closeModal=!0):($("#vaildMobileNumberError").velocity("slideUp"),$("#addContacViewAddButton").text("Add Contact"),addContactView._closeModal=!1))})},closeModal:function(){$("#modalview-AddContact").data("kendoMobileModalView").close()},addChatContact:function(t,e,a,c){var o=Parse.Object.extend("contacts"),n=new o;n.setACL(userModel.parseACL),n.set("name",e),n.set("alias",a),n.set("category","unknown"),n.set("address",null),n.set("group",null),n.set("priority",0),n.set("isFavorite",!1),n.set("isBlocked",!1),n.set("uuid",t),n.set("contactUUID",c),n.set("contactPhone",null),n.set("contactEmail",null),n.set("ownerUUID",userModel.currentUser.userUUID),n.save(null,{success:function(e){var a=contactModel.createIdenticon(t);e.set("photo",a),e.set("contactPhone",e.phone),e.set("phoneVerified",e.phoneVerified),e.set("contactEmail",e.email),e.set("emailVerified",e.emailVerified),contactModel.contactsDS.add(e.attributes),contactModel.contactListDS.add(e.attributes),addContactView.closeModal()},error:function(t,e){handleParseError(e)}})},validate:function(){var t=$("#addContactForm").kendoValidator().data("kendoValidator");t.validate()&&addContactView._closeModal===!1?addContactView.addContact():addContactView.closeModal()},addContact:function(t){_preventDefault(t);var e=Parse.Object.extend("contacts"),a=new e,c=$("#addContactName").val(),o=$("#addContactAlias").val(),n=$("#addContactPhone").val(),i=$("#addContactEmail").val(),d=$("#addContactPhoto").prop("src"),s=$("#addContactGroup").val(),r=$("#addContactAddress").val();if(null===n||n.length<10)return void mobileNotify("Contacts must have a valid phone number!");var l=uuid.v4();return a.setACL(userModel.parseACL),a.set("name",c),a.set("alias",o),a.set("address",r),a.set("group",s),a.set("category","new"),a.set("priority",0),a.set("isFavorite",!1),a.set("isBlocked",!1),a.set("uuid",l),a.set("contactUUID",null),a.set("contactPhone",null),a.set("contactEmail",null),a.set("ownerUUID",userModel.currentUser.userUUID),n=n.replace(/\D+/g,""),"1"!==n[0]&&(n="1"+n),void 0!==contactModel.findContactByPhone(n)?(mobileNotify("Existing contact with this phone number"),void addContactView.closeModal()):(a.set("phone",n),addContactView.closeModal(),mobileNotify("Invite sent"),void findUserByPhone(n,function(t){if(t.found){var e=t.user;a.set("phoneVerified",e.phoneVerified),e.emailVerified?(a.set("email",e.email),a.set("emailValidated",!0)):(a.set("email",i),a.set("emailValidated",!1)),a.set("contactUUID",e.userUUID),a.set("contactPhone",e.phone),a.set("phoneVerified",e.phoneVerified),e.phoneVerified&&(a.set("phone",e.phone),a.set("category","member")),a.set("contactEmail",e.email),a.set("photo",null),a.set("contactPhoto",e.photo),a.set("publicKey",e.publicKey)}else a.set("email",i),contactSendEmailInvite(i),a.set("phoneVerified",!1),a.set("publicKey",null),a.set("contactUUID",null),a.set("contactPhone",null),a.set("contactEmail",null);a.save(null,{success:function(t){mobileNotify("Added contact : "+t.get("name"));var e=contactModel.createIdenticon(l);t.set("identicon",e),(null!==t.attributes.photo||""!==t.attributes.photo)&&t.set("photo",e),contactModel.contactsDS.add(t.attributes),contactModel.contactListDS.add(t.attributes),addContactView.closeModal(),APP.kendo.navigate("#contacts")},error:function(t,e){handleParseError(e)}})}))}},editContactView={addressUpdate:!1,phoneUpdate:!1,emailUpdate:!1,memberUpdate:!1,publicKeyUpdate:!1,_activeContact:new kendo.data.ObservableObject,onInit:function(t){_preventDefault(t),$("#editContactForm").kendoValidator({errorTemplate:"<span class='error-msg'>#=message#</span>"})},updateVerifiedUX:function(t,e){t&&($("#edit-verified-phone").removeClass("hidden"),$("#editContactPhone").prop("readonly",!0)),e&&($("#edit-verified-email").removeClass("hidden"),$("#editContactEmail").prop("readonly",!0))},setActiveContact:function(t){void 0!==t&&(editContactView._activeContact.set("uuid",t.uuid),editContactView._activeContact.set("name",t.name),editContactView._activeContact.set("alias",t.alias),editContactView._activeContact.set("phone",t.phone),editContactView._activeContact.set("phoneVerified",t.phoneVerified),editContactView._activeContact.set("email",t.email),editContactView._activeContact.set("emailVerified",t.emailValidated),editContactView._activeContact.set("group",t.group),editContactView._activeContact.set("isFavorite",t.isFavorite),editContactView._activeContact.set("isBlocked",t.isBlocked),editContactView._activeContact.set("photo",t.photo),editContactView._activeContact.set("inviteSent",t.inviteSent),editContactView._activeContact.set("connectSent",t.connectSent),editContactView._activeContact.set("connectReceived",t.connectReceived),editContactView._activeContact.set("address",t.address),editContactView._activeContact.set("category",t.category),void 0!==t.contactUUID&&(editContactView._activeContact.set("contactUUID",t.contactUUID),editContactView._activeContact.set("contactPhone",t.contactPhone),editContactView._activeContact.set("contactEmail",t.contactEmail),editContactView._activeContact.set("contactAddress",t.contactAddress),editContactView._activeContact.set("publicKey",t.publicKey)),void 0!==t.memberUpdate&&(editContactView.memberUpdate=!0,mobileNotify(t.alias+"( "+t.name+") is now a member!")),void 0!==t.phoneUpdate&&(editContactView.phoneUpdate=!0,mobileNotify(t.alias+"( "+t.name+") has updated their phone number!"),editContactView._activeContact.set("phone",t.contactPhone)),void 0!==t.emailUpdate&&(editContactView.emailUpdate=!0,mobileNotify(t.alias+"( "+t.name+") has updated their email address!"),editContactView._activeContact.set("email",t.contactEmail)))},updateContact:function(){var t=contactModel.findContactByUUID(editContactView._activeContact.uuid),e=contactModel.findContactListUUID(editContactView._activeContact.uuid);t.set("name",editContactView._activeContact.name),t.set("alias",editContactView._activeContact.alias),t.set("phone",editContactView._activeContact.phone),t.set("email",editContactView._activeContact.email),t.set("photo",editContactView._activeContact.photo),t.set("isFavorite",editContactView._activeContact.isFavorite),t.set("isBlocked",editContactView._activeContact.isBlocked),void 0!==editContactView._activeContact.contactUUID&&null!==editContactView._activeContact.contactUUID&&(t.set("contactUUID",editContactView._activeContact.contactUUID),t.set("contactEmail",editContactView._activeContact.contactEmail),t.set("contactPhone",editContactView._activeContact.contactPhone),t.set("contactAddress",editContactView._activeContact.contactAddress),t.set("publicKey",editContactView._activeContact.publicKey)),t.set("group",editContactView._activeContact.group),t.set("address",editContactView._activeContact.address),t.set("category",editContactView._activeContact.category),e.set("name",editContactView._activeContact.name),e.set("alias",editContactView._activeContact.alias),e.set("phone",editContactView._activeContact.phone),e.set("email",editContactView._activeContact.email),e.set("photo",editContactView._activeContact.photo),e.set("group",editContactView._activeContact.group),e.set("isFavorite",editContactView._activeContact.isFavorite),e.set("isBlocked",editContactView._activeContact.isBlocked),e.set("address",editContactView._activeContact.address),e.set("category",editContactView._activeContact.category),void 0!==editContactView._activeContact.contactUUID&&null!==editContactView._activeContact.contactUUID&&(e.set("contactUUID",editContactView._activeContact.contactUUID),e.set("contactEmail",editContactView._activeContact.contactEmail),e.set("contactPhone",editContactView._activeContact.contactPhone),e.set("contactAddress",editContactView._activeContact.contactAddress),e.set("publicKey",editContactView._activeContact.publicKey)),updateParseObject("contacts","uuid",editContactView._activeContact.uuid,"name",editContactView._activeContact.name),updateParseObject("contacts","uuid",editContactView._activeContact.uuid,"alias",editContactView._activeContact.alias),updateParseObject("contacts","uuid",editContactView._activeContact.uuid,"phone",editContactView._activeContact.phone),updateParseObject("contacts","uuid",editContactView._activeContact.uuid,"email",editContactView._activeContact.email),updateParseObject("contacts","uuid",editContactView._activeContact.uuid,"photo",editContactView._activeContact.photo),updateParseObject("contacts","uuid",editContactView._activeContact.uuid,"group",editContactView._activeContact.group),updateParseObject("contacts","uuid",editContactView._activeContact.uuid,"isFavorite",editContactView._activeContact.isFavorite),updateParseObject("contacts","uuid",editContactView._activeContact.uuid,"isBlocked",editContactView._activeContact.isBlocked),updateParseObject("contacts","uuid",editContactView._activeContact.uuid,"address",editContactView._activeContact.address),updateParseObject("contacts","uuid",editContactView._activeContact.uuid,"category",editContactView._activeContact.category),void 0!==editContactView._activeContact.contactUUID&&null!==editContactView._activeContact.contactUUID&&(updateParseObject("contacts","uuid",editContactView._activeContact.uuid,"contactUUID",editContactView._activeContact.contactUUID),updateParseObject("contacts","uuid",editContactView._activeContact.uuid,"contactPhone",editContactView._activeContact.contactPhone),updateParseObject("contacts","uuid",editContactView._activeContact.uuid,"contactEmail",editContactView._activeContact.contactEmail),updateParseObject("contacts","uuid",editContactView._activeContact.uuid,"contactAddress",editContactView._activeContact.contactAddress),updateParseObject("contacts","uuid",editContactView._activeContact.uuid,"publicKey",editContactView._activeContact.publicKey))},syncActiveContact:function(t){_preventDefault(t),"emailVerified"!==t.field&&updateParseObject("contacts","uuid",editContactView._activeContact.uuid,t.field,this[t.field])},onShow:function(t){_preventDefault(t);var e=t.view.params.contact,a=null;a=contactModel.findContactByUUID(e),void 0!==a?editContactView.setActiveContact(a):mobileNotify("EditContact : invalid contactId "+e),contactModel.updateContactDetails(e,function(t){editContactView.setActiveContact(t),editContactView.updateVerifiedUX(t.phoneVerified,t.emailValidated),editContactView.updateContact()}),editContactView._activeContact.phoneVerified?$("#edit-verified-phone").addClass("hidden"):$("#edit-verified-phone").addClass("hidden"),editContactView._activeContact.emailVerified?$("#edit-verified-email").addClass("hidden"):$("#edit-verified-email").addClass("hidden")},validate:function(){var t=$("#editContactForm").kendoValidator().data("kendoValidator");t.validate()&&editContactView.updateDone()},updateDone:function(t){_preventDefault(t),editContactView.updateContact(),editContactView.onDone()},onDone:function(t){_preventDefault(t),APP.kendo.navigate("#contacts"),$("#contactEditList").velocity("fadeIn")},syncWithParse:function(t){_preventDefault(t),mobileNotify("Getting lastest info for "+contactModel.currentContact.name);var e=editContactView._activeContact;void 0!==e.contactUUID?getUserContactInfo(e.contactUUID,function(t){if(t.found){var a=t.user,c=!1;e.email!==a.email&&(c=!0,e.email=a.email,mobileNotify(e.name+" has changed their preferred email.")),e.phone!==a.phone&&(c=!0,e.phone=a.phone,mobileNotify(e.name+" has changed their preferred phone.")),e.phoneVerified!==a.phoneVerified&&(c=!0,e.phoneVerified=a.phoneVerified,mobileNotify(e.name+" has verified their phone.")),e.emailValidated!==a.emailVerified&&(c=!0,e.set("emailValidated",a.emailVerified),mobileNotify(e.name+" has verified their email.")),e.publicKey!==a.publicKey&&(c=!0,e.publicKey=a.publicKey,mobileNotify(e.name+" has changed their public key.")),editContactView.updateVerifiedUX(e.phoneVerified,e.emailValidated)}}):findUserByPhone(e.phone,function(t){if(t.found){var a=t.user,c=!1;e.email!==a.email&&(c=!0,e.email=a.email,mobileNotify(e.name+" has changed their preferred email.")),e.phone!==a.phone&&(c=!0,e.phone=a.phone,mobileNotify(e.name+" has changed their preferred phone.")),e.phoneVerified!==a.phoneVerified&&(c=!0,e.phoneVerified=a.phoneVerified,mobileNotify(e.name+" has verified their phone.")),e.emailValidated!==a.emailVerified&&(c=!0,e.set("emailValidated",a.emailVerified),mobileNotify(e.name+" has verified their email.")),e.publicKey!==a.publicKey&&(c=!0,e.publicKey=a.publicKey,mobileNotify(e.name+" has changed their public key.")),editContactView.updateVerifiedUX(e.phoneVerified,e.emailValidated)}})},syncWithDevice:function(t){}},contactActionView={_activeContactId:null,_returnModalId:null,_activeContact:new kendo.data.ObservableObject,onInit:function(t){},refreshUX:function(t){"unknown"===t.category?($("#contactActionBtns").addClass("hidden"),$("#contactActionConnect").removeClass("hidden"),$("#contactActionAccept").addClass("hidden")):($("#contactActionBtns").removeClass("hidden"),$("#contactActionConnect").addClass("hidden"),$("#contactActionAccept").addClass("hidden"),"member"===t.category?$("#contactActionBtns > li:first-child").show():$("#contactActionBtns > li:first-child").hide())},setReturnModal:function(t){contactActionView._returnModalId=t},openModal:function(t){$("#contactActionBtns").removeClass("hidden");var e=contactModel.findContactByUUID(t);contactActionView.setContact(e),contactActionView.refreshUX(e),$(".statusContactCard-icon").attr("src","images/status-away.svg"),void 0!==e.contactUUID&&null!==e.contactUUID&&contactModel.getContactStatusObject(e.contactUUID,function(t){if(null!==t){var a=t.get("isAvailable");contactActionView._activeContact.set("contactUUID",e.contactUUID),contactActionView._activeContact.set("statusMessage",t.get("statusMessage")),contactActionView._activeContact.set("currentPlace",t.get("currentPlace")),contactActionView._activeContact.set("currentPlaceUUID",t.get("currentPlaceUUID")),contactActionView._activeContact.set("isAvailable",a),a&&$(".statusContactCard-icon").attr("src","images/status-available.svg");var c=contactModel.findContactList(e.contactUUID);c.set("statusMessage",t.get("statusMessage"));var o=t.get("currentPlace");c.set("currentPlace",o),c.set("currentPlaceUUID",t.get("currentPlaceUUID")),c.set("isAvailable",a),""!==o&&void 0!==o&&$("#contactCurrentPlace").text("@"+o)}}),contactModel.updateContactDetails(t,function(e){void 0===e&&(e=contactModel.findContactByUUID(t));var a=e.name,c=e.alias,o=e.phoneVerified,n=e.group,i=e.isAvailable;""!==n&&null!==n?($("#currentGroup").removeClass("hidden"),$("#currentContactGroup").text(n)):($("#currentGroup").addClass("hidden"),$("#currentContactGroup").text("")),contactActionView._activeContact.set("contactUUID",e.contactUUID),contactActionView._activeContact.set("publicKey",e.publicKey),contactActionView._activeContact.set("phone",e.phone),contactActionView._activeContact.set("name",a),contactActionView._activeContact.set("alias",c),void 0!==e.photo&&null!==e.photo?contactActionView._activeContact.set("photo",e.photo):contactActionView._activeContact.set("photo",e.identicon),ux.formatNameAlias(a,c,"#modalview-contactActions"),o?$("#currentContactVerified").removeClass("hidden"):$("#currentContactVerified").addClass("hidden"),$("#contactProfileImg").attr("src",e.photo),contactActionView.refreshUX(e)}),$("#modalview-contactActions").data("kendoMobileModalView").open(),$("#contactProfileImg").velocity("fadeIn",{delay:150,duration:300,display:"inline-block"}),$("#contactStatusImg").velocity("fadeIn",{delay:150,duration:300,display:"inline-block"}),$("#modalview-contactActions .modal-top h2").velocity({translateY:"20%",opacity:1},{delay:300,duration:500,display:"block"}),$("#modalview-contactActions .modal-top p").velocity({translateY:"20%",opacity:1},{delay:600,duration:500,display:"block"}),$("#modalview-contactActions .modal-bottom .hasMotion").velocity("fadeIn",{duration:500,delay:700})},closeModal:function(){$("#modalview-contactActions").data("kendoMobileModalView").close(),$("#contactCurrentPlace").text(""),$("#modalview-contactActions .preMotionUp, #modalview-contactActions .hasMotion").css("display","none").velocity("fadeOut",{opacity:0,translateY:"0%"}),$("#contactProfileImg, #contactStatusImg").css("opacity",0),null!==contactActionView._returnModalId&&($(contactActionView._returnModalId).data("kendoMobileModalView").open(),contactActionView._returnModalId=null)},restoreModal:function(){contactActionView.openModal(contactActionView._activeContactId)},privateChat:function(t){_preventDefault(t);var e=contactActionView._activeContact,a=e.contactUUID,c=e.name,o=e.publicKey;if(void 0===a||null===a)return void mobileNotify(e.name+" hasn't verified their contact info");var n=channelModel.findPrivateChannel(a),i="#channel?channelId=";void 0!==n?(i+=n.channelId,APP.kendo.navigate(i)):(channelModel.addPrivateChannel(a,o,c),i+=a,APP.kendo.navigate(i))},ghostEmail:function(t){_preventDefault(t);var e=APP.kendo.view().id;contactActionView.closeModal(),APP.kendo.navigate("#ghostEditor?returnview="+e+"&callback=contactaction")},callPhone:function(t){if(_preventDefault(t),window.navigator.simulator===!0)return void mobileNotify("Phone Calls are't supported in the emulator");var e=contactActionView._activeContact.get("phone");window.plugins.CallNumber.callNumber(function(t){mobileNotify("Dialing "+e)},function(t){mobileNotify("Dailer error: "+t)},e)},sendSMS:function(t){_preventDefault(t);var e=contactActionView._activeContact.get("phone"),a="",c={android:{intent:"INTENT"}},o=function(){mobileNotify("Message sent successfully")},n=function(t){mobileNotify("Message Failed:"+t)};window.navigator.simulator===!0?alert("Simulating SMS to "+e+" message: "+a):sms.send(e,a,c,o,n)},setContact:function(t){contactActionView._activeContactId=t.uuid,contactActionView._activeContact.set("name",t.name),contactActionView._activeContact.set("alias",t.alias),contactActionView._activeContact.set("photo",t.photo),contactActionView._activeContact.set("contactUUID",t.contactUUID),contactActionView._activeContact.set("contactKey",t.contactKey),contactActionView._activeContact.set("statusMessage",t.statusMessage),contactActionView._activeContact.set("currentPlace",t.currentPlace),contactActionView._activeContact.set("isAvailable",t.isAvailable),t.isAvailable&&$(".statusContactCard-icon").attr("src","images/status-available.svg"),t.phoneVerified?$("#currentContactVerified").removeClass("hidden"):$("#currentContactVerified").addClass("hidden")}};