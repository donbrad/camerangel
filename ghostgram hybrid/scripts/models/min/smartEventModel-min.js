"use strict";var smartEvent={termMap:[{term:"call",category:"action",type:"meeting",composite:!0,date:1,place:0,info:0},{term:"conference",category:"action",type:"meeting",composite:!0,date:1,place:0,info:1},{term:"coffee",category:"action",type:"meeting",composite:!0,date:1,place:1,info:0},{term:"beers",category:"action",type:"meeting",composite:!0,date:1,place:1,info:0},{term:"breakfast",category:"action",type:"meeting",composite:!0,date:1,place:1,info:0},{term:"brunch",category:"action",type:"meeting",composite:!0,date:1,place:1,info:0},{term:"lunch",category:"action",type:"meeting",composite:!0,date:1,place:1,info:0},{term:"dinner",category:"action",type:"meeting",composite:!0,date:1,place:1,info:0},{term:"drinks",category:"action",type:"meeting",composite:!0,date:1,place:1,info:0},{term:"cocktails",category:"action",type:"meeting",composite:!0,date:1,place:1,info:0},{term:"dessert",category:"action",type:"meeting",composite:!0,date:1,place:-1,info:0},{term:"meeting",category:"action",type:"meeting",composite:!0,date:1,place:1,info:0},{term:"theatre",category:"action",type:"event",composite:!0,date:1,place:1,info:1},{term:"concert",category:"action",type:"event",composite:!0,date:1,place:1,info:0},{term:"flight",category:"action",type:"flight",composite:!0,date:1,place:1,info:1},{term:"rideshare",category:"action",type:"meeting",composite:!0,date:1,place:1,info:0},{term:"shopping",category:"action",type:"activity",composite:!0,date:1,place:1,info:0},{term:"run",category:"action",type:"activity",composite:!0,date:1,place:1,info:0},{term:"jog",category:"action",type:"activity",composite:!0,date:1,place:1,info:0},{term:"hike",category:"action",type:"activity",composite:!0,date:1,place:1,info:0},{term:"bike",category:"action",type:"activity",composite:!0,date:1,place:1,info:0},{term:"watch",category:"action",type:"tvshow",composite:!0,date:1,place:-1,info:0},{term:"movie",category:"action",type:"meeting",composite:!0,date:1,place:-1,info:0},{term:"movies",category:"action",type:"movies",composite:!0},{term:"goto",category:"action",type:"event",composite:!0,date:1,place:-1,info:0},{term:"tvshow",category:"action",type:"tvshow",composite:!0,date:1,place:0,info:0},{term:"tvmovie",category:"action",type:"tvmovie",composite:!0,date:1,place:0,info:0},{term:"showing",category:"action",type:"movie",composite:!0,date:1,place:0,info:0},{term:"am",category:"calendar",type:"time",composite:!0},{term:"pm",category:"calendar",type:"time",composite:!0},{term:"oclock",category:"calendar",type:"time",composite:!0},{term:"tomorrow",category:"calendar",type:"datejs",composite:!1},{term:"today",category:"calendar",type:"datejs",composite:!1},{term:"week",category:"calendar",type:"datejs",composite:!1},{term:"month",category:"calendar",type:"datejs",composite:!1},{term:"morning",category:"calendar",type:"time-macro",composite:!1,start:"5:00am",end:"11:00am"},{term:"early morning",category:"calendar",type:"time-macro",composite:!1,start:"5:00am",end:"8:00am"},{term:"late morning",category:"calendar",type:"time-macro",composite:!1,start:"9:00am",end:"11:00am"},{term:"midmorning",category:"calendar",type:"time-macro",composite:!1,start:"8:00am",end:"10:00am"},{term:"afternoon",category:"calendar",type:"time-macro",composite:!1,start:"1:00pm",end:"5:00pm"},{term:"early afternoon",category:"calendar",type:"time-macro",composite:!1,start:"1:00pm",end:"3:00pm"},{term:"evening",category:"calendar",type:"time-macro",composite:!1,start:"5:00am",end:"11:00am"},{term:"night",category:"calendar",type:"time-macro",composite:!1,start:"7:00pm",end:"9:00pm"},{term:"late night",category:"calendar",type:"time-macro",composite:!1,start:"10:00pm",end:"2:00am"},{term:"early evening",category:"calendar",type:"time-macro",composite:!1,start:"5:00pm",end:"7:00pm"},{term:"next",category:"calendar",type:"datejs",composite:!0},{term:"second",category:"calendar",type:"datejs",composite:!0},{term:"mon",category:"calendar",type:"day",composite:!0},{term:"tue",category:"calendar",type:"day",composite:!0},{term:"wed",category:"calendar",type:"day",composite:!0},{term:"thu",category:"calendar",type:"day",composite:!0},{term:"fri",category:"calendar",type:"day",composite:!0},{term:"sat",category:"calendar",type:"day",composite:!0},{term:"sun",category:"calendar",type:"day",composite:!0},{term:"monday",category:"calendar",type:"day",composite:!0},{term:"tuesday",category:"calendar",type:"day",composite:!0},{term:"wednesday",category:"calendar",type:"day",composite:!0},{term:"thursday",category:"calendar",type:"day",composite:!0},{term:"friday",category:"calendar",type:"day",composite:!0},{term:"saturday",category:"calendar",type:"day",composite:!0},{term:"sunday",category:"calendar",type:"day",composite:!0},{term:"jan",category:"calendar",type:"month",composite:!0},{term:"feb",category:"calendar",type:"month",composite:!0},{term:"mar",category:"calendar",type:"month",composite:!0},{term:"apr",category:"calendar",type:"month",composite:!0},{term:"may",category:"calendar",type:"month",composite:!0},{term:"jun",category:"calendar",type:"month",composite:!0},{term:"jul",category:"calendar",type:"month",composite:!0},{term:"aug",category:"calendar",type:"month",composite:!0},{term:"sep",category:"calendar",type:"month",composite:!0},{term:"oct",category:"calendar",type:"month",composite:!0},{term:"nov",category:"calendar",type:"month",composite:!0},{term:"dec",category:"calendar",type:"month",composite:!0},{term:"january",category:"calendar",type:"month",composite:!0},{term:"february",category:"calendar",type:"month",composite:!0},{term:"march",category:"calendar",type:"month",composite:!0},{term:"april",category:"calendar",type:"month",composite:!0},{term:"may",category:"calendar",type:"month",composite:!0},{term:"june",category:"calendar",type:"month",composite:!0},{term:"july",category:"calendar",type:"month",composite:!0},{term:"august",category:"calendar",type:"month",composite:!0},{term:"september",category:"calendar",type:"month",composite:!0},{term:"october",category:"calendar",type:"month",composite:!0},{term:"november",category:"calendar",type:"month",composite:!0},{term:"december",category:"calendar",type:"month",composite:!0},{term:"near",category:"target",type:"location",composite:!0},{term:"in",category:"target",type:"location",composite:!0},{term:"at",category:"target",type:"ambig",composite:!0},{term:"on",category:"target",type:"ambig",composite:!0},{term:"title",category:"photo",type:"meta",composite:!1},{term:"tags",category:"photo",type:"meta",composite:!1},{term:"description",category:"photo",type:"meta",composite:!1}],timeMacroList:[{term:"morning",start:"6:30am",end:"8:30am"},{term:"midmorning",start:"8:30am",end:"10:30am"},{term:"noon",start:"11:30am",end:"12:30pm"},{term:"afternoon",start:"1:00pm",end:"5:00pm"},{term:"evening",start:"5:00pm",end:"9:00pm"},{term:"night",start:"8:00pm",end:"11:30pm"}],termsDS:null,objectsDS:new kendo.data.DataSource({offlineStorage:"smartEvent",sort:{field:"date",dir:"desc"}}),init:function(){smartEvent.termsDS=new kendo.data.DataSource({data:smartEvent.termMap})},fetch:function(){var e=Parse.Object.extend("smartobject"),t=new Parse.Query(e);t.find({success:function(e){for(var t=[],a=0;a<e.length;a++){var o=e[a];t.push(o.toJSON())}deviceModel.setAppState("hasSmartObjects",!0),smartEvent.objectsDS.data(t),deviceModel.isParseSyncComplete()},error:function(e){handleParseError(e)}})},queryTerm:function(e){if(void 0!==e){var t=smartEvent.termsDS,a=t.filter();void 0===a&&(a={}),t.filter(e);var o=t.view();return t.filter(a),o}},queryObjects:function(e){if(void 0!==e){var t=smartEvent.objectsDS,a=t.filter();void 0===a&&(a={}),t.filter(e);var o=t.view();return t.filter(a),o}},queryObject:function(e){if(void 0!==e){var t=smartEvent.objectsDS,a=t.filter();void 0===a&&(a={}),t.filter(e);var o=t.view();return t.filter(a),void 0===o.items?void 0:o[0]}},findObject:function(e){var t=smartEvent.queryObject([{field:"uuid",operator:"eq",value:e},{field:"isDeleted",operator:"eq",value:!1}]);return t},getActionNames:function(){for(var e=[],t=smartEvent.queryTerm({field:"category",operator:"eq",value:"action"}),a=0;a<t.length;a++)e.push(t[a].term);return e},isCurrentAction:function(e){var t=e.toLowerCase(),a=smartEvent.queryTerm({field:"action",operator:"eq",value:t});return a.length>0?!0:!1},findTerm:function(e){var t=e.toLowerCase(),a=smartEvent.queryTerm({field:"term",operator:"eq",value:t});return a},containsTerm:function(e){var t=e.toLowerCase(),a=smartEvent.queryTerm({field:"term",operator:"contains",value:t});return a},startsWithTerm:function(e){var t=e.toLowerCase(),a=smartEvent.queryTerm({field:"term",operator:"startswith",value:t});return a},smartAddObject:function(e){var t=e.uuid;void 0===smartEvent.findObject(t)&&smartEvent.addObject(e)},accept:function(e,t,a){var o=smartEvent.findObject(e);void 0!==o&&(o.set("isAccepted",!0),o.set("isDeclined",!1),appDataChannel.eventAccept(e,t,userModel.currentUser.userUUID,a),updateParseObject("smartobject","uuid",e,"isAccepted",!0),updateParseObject("smartobject","uuid",e,"isDeclined",!1))},decline:function(e,t,a){var o=smartEvent.findObject(e);void 0!==o&&(o.set("isAccepted",!1),o.set("isDeclined",!0),appDataChannel.eventDecline(e,t,userModel.currentUser.userUUID,a),updateParseObject("smartobject","uuid",e,"isAccepted",!1),updateParseObject("smartobject","uuid",e,"isDeclined",!0))},recipientAccept:function(e,t,a){var o=smartEvent.findObject(e);if(void 0!==o){var r=o.rsvpList,c=contactModel.findContact(t);if(void 0!==c){var n={date:new Date,isAccepted:!0,contactId:t,contactName:c.name,comment:a};o.rsvpList.push(n),updateParseObject("smartobject","uuid",e,"rsvpList",o.rsvpList)}}},recipientDecline:function(e,t,a){var o=smartEvent.findObject(e);if(void 0!==o){var r=o.rsvpList,c=contactModel.findContact(t);if(void 0!==c){var n={date:new Date,isAccepted:!1,contactId:t,contactName:c.name,comment:a};o.rsvpList.push(n),updateParseObject("smartobject","uuid",e,"rsvpList",o.rsvpList)}}},update:function(e,t,a){var o=smartEvent.findObject(e)},cancel:function(e,t){var a=smartEvent.findObject(e);void 0!==a&&(a.set("wasCancelled",!0),updateParseObject("smartobject","uuid",e,"wasCancelled",!0))},addObject:function(e){var t=Parse.Object.extend("smartobject"),a=new t;(void 0===e.senderUUID||null===e.senderUUID)&&(e.senderUUID=userModel.currentUser.userUUID),a.setACL(userModel.parseACL),a.set("uuid",e.uuid),a.set("senderUUID",e.senderUUID),a.set("senderName",e.senderName),a.set("channelId",e.channelId),a.set("calendarId",e.calendarId),a.set("eventChatId",e.eventChatId),a.set("action",e.action),a.set("type",e.type),a.set("title",e.title),a.set("description",e.description);var o=new Date(e.date).toISOString(),r={__type:"Date",iso:o};a.set("date",r),a.set("duration",e.duration),a.set("durationString",e.durationString),a.set("approxTime",e.approxTime),a.set("approxPlace",e.approxPlace),a.set("address",e.address),a.set("lat",e.lat),a.set("lng",e.lng),a.set("placeId",e.placeId),a.set("placeFlexible",e.placeFlexible),a.set("timeFlexible",e.timeFlexible),a.set("isAccepted",e.isAccepted),a.set("isModified",e.isModified),a.set("isDeleted",e.isDeleted),a.set("wasCancelled",e.wasCancelled),a.set("inviteList",e.inviteList),a.set("rsvpList",e.rsvpList);var c=a.toJSON();smartEvent.objectsDS.add(c),a.save(null,{success:function(e){},error:function(e,t){handleParseError(t)}})},removeFromList:function(e,t){var a=e.filter(function(e){return e!=t});return a}};