<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta charset="utf-8" />
    <link href="kendo/styles/kendo.mobile.all.min.css" rel="stylesheet" />
    <link href="styles/main.css" rel="stylesheet" />

    <script src="cordova.js"></script>
    <script src="kendo/js/jquery.min.js"></script>
    <script src="kendo/js/kendo.mobile.min.js"></script>

    <script src="scripts/app.js"></script>
    <script src="scripts/parse.js"></script>

    <script>
   

    function togglePrivate () {
        var privateMode = !APP.models.home.privateMode;
        APP.models.home.privateMode = privateMode;
        if (privateMode) {
            $('.privateModeButton').text('Private');
            $('.user-content').removeClass('publicMode');
            $('.user-content').addClass('privateMode');

        } else {
            $('.privateModeButton').text('Public');
            $('.user-content').addClass('publicMode');
            $('.user-content').removeClass('privateMode');
        }
    }
        
    function haveActiveUser () {
      $('#home-signin').addClass('hidden');
      $('#home-status').removeClass('hidden');
    },
        
    function noActiveUser () {
      $('#home-signin').removeClass('hidden');
      $('#home-status').addClass('hidden');
    }

    function beforeShowFilter() {

        if (APP.models.home.privateMode) {
            $('.privateModeButton').text('Private');
            $('.user-content').removeClass('publicMode');
            $('.user-content').addClass('privateMode');

        } else {
            $('.privateModeButton').text('Public');
            $('.user-content').addClass('publicMode');
            $('.user-content').removeClass('privateMode');
        }   
    }
    
    function homeSignout () {
       
        Parse.User.logOut();
        noActiveUser();
    }
        
    function homeSignin () {
       Parse.User.logIn($('#home-signin-username').val(), $('#home-signin-password').val(), {
            success: function(user) {
            // Do stuff after successful login.
                closeModalViewLogin();
                haveActiveUser();
            },
            error: function(user, error) {
            // The login failed. Check error to see why.
                 alert("Error: " + error.code + " " + error.message);
            }
        });
    }
   
    function closeModalViewLogin() {
        $("#modalview-login").kendoMobileModalView("close");
    }
        
    function closeModalViewSignup() {
        $("#modalview-signup").kendoMobileModalView("close");
    }
        
    function homeCreateAccount() {
        var user = new Parse.User();
        var username = $('#home-signup-username').val();
        var password = $('#home-signup-password').val();
        var email =  $('#home-signup-email').val();
        var phone = $('#home-signup-phone').val();
        
        APP.models.profile.userName = username;
         APP.models.profile.email = email;
         APP.models.profile.phone = phone;
        
        //Todo: add validation for user entry and prior to parse call
        user.set("username", username);
        user.set("password", password);
        user.set("email", email);
        user.set("phone", phone);

        user.signUp(null, {
            success: function(user) {
                // Hooray! Let them use the app now.
               closeModalViewSignup();
               haveActiveUser();
            },
            
            error: function(user, error) {
            // Show the error message somewhere and let the user try again.
            alert("Error: " + error.code + " " + error.message);
            }
        });
    }
        
    function introChanging () {
        $('.intro-photo-block').removeClass('animated fadeIn');
        $('.intro-photo-block').addClass('hidden');
    }

    function introChanged () {
        $('.intro-photo-block').removeClass('hidden');
        $('.intro-photo-block').addClass('animated fadeIn');
    }
</script>

</head>
<body>
 
<div data-role="layout" data-id="main">
    <div data-role="header">
        <div data-role="navbar">
            <span data-role="view-title"></span>
            <a data-role="button" href="#appDrawer" data-rel="drawer" data-align="left" data-icon="drawer-button"></a>
            <a data-role="button" data-click="togglePrivate" data-align="right" >Public</a>
        </div>
    </div>

    <div data-role="content" class='view-content'>
    <!-- application views will be rendered here -->
    </div>

</div>

  <!-- application drawer and contents -->
  <div data-role="drawer" id="appDrawer" style="width: 180px" data-title="Main Menu">
    <div data-role="header">
      <div data-role="navbar">
        <span data-role="view-title"></span>
      </div>
    </div>
    <ul data-role="listview">
      <li>
        <a href="views/home.html">Home</a>
      </li>
      <li>
        <a href="views/profile.html">Profile</a>
      </li>
      <li>
        <a href="views/channels.html">Channels</a>
      </li>
          <li>
        <a href="views/gallery.html">Gallery</a>
      </li>
      <li>
        <a href="views/contacts.html">Contacts</a>
      </li>
    </ul>
  </div>       

</body>
</html>
